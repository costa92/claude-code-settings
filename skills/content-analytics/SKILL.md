---
name: content-analytics
description: Analyze WeChat Official Account article performance data from exported CSV/Excel files. Provides insights on reading trends, completion rate, sharing patterns, follower growth, and content strategy recommendations. Use when the user wants to analyze article performance, understand audience behavior, or make data-driven content decisions. Triggers on "数据分析", "文章数据", "阅读量分析", "粉丝分析", "content analytics", "article performance", "公众号数据".
---

# Content Analytics

**分析微信公众号文章数据，用数据驱动内容策略**

---

## 数据来源

### 微信公众号后台导出数据

用户需从微信公众号后台导出以下数据（通常为 CSV 或 Excel 格式）：

1. **图文分析数据**：阅读量、点赞、在看、转发、收藏、评论数
2. **用户增长数据**：关注/取关、净增、累计关注
3. **用户属性数据**：性别、地区、语言、来源渠道
4. **菜单/消息数据**（可选）：菜单点击、消息互动

### 数据读取

使用 `xlsx` skill 或 pandas 读取数据文件：

```python
import pandas as pd

# 读取微信导出的 CSV/Excel
df = pd.read_csv('wechat_article_data.csv', encoding='utf-8')
# 或
df = pd.read_excel('wechat_article_data.xlsx')
```

---

## 分析模块

### 1. 文章表现总览

**核心指标仪表盘**：

```markdown
## 📊 数据总览 (时间范围: YYYY/MM/DD - YYYY/MM/DD)

### 关键指标
| 指标 | 本期 | 上期 | 变化 |
|------|------|------|------|
| 总阅读量 | | | ↑X% / ↓X% |
| 篇均阅读 | | | |
| 总点赞 | | | |
| 总在看 | | | |
| 总转发 | | | |
| 新增关注 | | | |
| 取消关注 | | | |
| 净增粉丝 | | | |

### 最佳表现文章 TOP 5
| 排名 | 标题 | 阅读量 | 点赞 | 在看 | 转发 |
|------|------|--------|------|------|------|
```

### 2. 内容效果分析

**文章类型效果对比**：
- 按文章类型分组（教程/解析/观点/评测/资讯）
- 对比每种类型的平均阅读量、互动率、转发率
- 找出最适合你的读者的内容类型

**关键比率计算**：

```
互动率 = (点赞 + 在看 + 评论) / 阅读量 × 100%
  → 行业均值约 1-3%，超过 3% 属于优秀

转发率 = 转发数 / 阅读量 × 100%
  → 行业均值约 0.5-1%，超过 2% 属于爆款

完读率 ≈ (文末点击数 or 在看数) / 阅读量 × 100% (近似)
  → 微信不直接提供，可用在看/阅读量近似

收藏率 = 收藏数 / 阅读量 × 100%
  → 高收藏 = 内容实用，即使阅读量不高也有长尾价值

粉丝转化率 = 新增关注 / 阅读量 × 100%
  → 反映内容对新读者的吸引力
```

**⚠️ 重要：所有比率必须用代码精确计算，禁止心算或估算。** 使用以下 Python 代码：

```python
import pandas as pd

# 读取数据后，计算所有关键比率
def calculate_metrics(df):
    """计算微信公众号核心指标。列名需包含：阅读量, 点赞, 在看, 转发, 收藏, 新增关注"""
    total_reads = df['阅读量'].sum()
    metrics = {
        '总阅读量': total_reads,
        '篇均阅读': round(df['阅读量'].mean(), 1),
        '篇均点赞': round(df['点赞'].mean(), 1),
        '篇均在看': round(df['在看'].mean(), 1),
        '篇均转发': round(df['转发'].mean(), 1),
        '篇均收藏': round(df['收藏'].mean(), 1),
    }
    # 比率计算 — 必须用 sum 聚合后再除，不能逐行取平均
    comment_col = df['评论'] if '评论' in df.columns else 0
    metrics['互动率'] = round((df['点赞'].sum() + df['在看'].sum() + (comment_col.sum() if hasattr(comment_col, 'sum') else 0)) / total_reads * 100, 2)
    metrics['转发率'] = round(df['转发'].sum() / total_reads * 100, 2)
    metrics['收藏率'] = round(df['收藏'].sum() / total_reads * 100, 2)
    if '新增关注' in df.columns:
        metrics['粉丝转化率'] = round(df['新增关注'].sum() / total_reads * 100, 2)
    return metrics

# 使用方法：
# df = pd.read_csv('data.csv')  或  pd.read_excel('data.xlsx')
# results = calculate_metrics(df)
# for k, v in results.items():
#     print(f"{k}: {v}{'%' if '率' in k else ''}")
```

**每次分析时必须运行此代码获取精确数值，再填入报告模板。**

### 3. 时间模式分析

**发布时间 vs 阅读表现**：
- 按发布时间（小时）分析平均阅读量
- 找出你的读者最活跃的时间段
- 按星期几分析效果差异

**时间衰减分析**：
- 发布后 1小时 / 24小时 / 48小时 / 7天 的阅读量占比
- 判断文章是"爆发型"（靠推送）还是"长尾型"（靠搜索）

### 4. 读者行为分析

**阅读来源分析**：
- 公众号消息（推送打开）
- 朋友圈（转发带来）
- 搜一搜（搜索流量）
- 好友转发（私域传播）
- 其他（历史消息、菜单等）

**行为漏斗**：
```
打开文章 → 阅读完成 → 点赞/在看 → 转发 → 关注
  100%    →   ~30%    →   ~2%     → ~1%  → ~0.5%
```

### 5. 增长分析

**粉丝增长趋势**：
- 日/周/月净增粉丝折线图
- 关注来源渠道分析
- 取关率趋势和可能原因

**增长归因**：
- 哪些文章带来了最多的新关注？
- 取关高峰是否关联到特定内容？

### 6. 竞争力诊断

**你的内容健康度评分**：

```markdown
## 🏥 内容健康度诊断

| 维度 | 评分 | 状态 | 建议 |
|------|------|------|------|
| 阅读量趋势 | X/10 | ↑增长/→平稳/↓下降 | |
| 互动质量 | X/10 | | |
| 内容一致性 | X/10 | 发布频率是否稳定 | |
| 粉丝忠诚度 | X/10 | 打开率/取关率 | |
| 传播能力 | X/10 | 转发率 | |
| 搜索价值 | X/10 | 搜一搜流量占比 | |
```

---

## 输出格式

### 完整分析报告

```markdown
# 📊 公众号数据分析报告
**时间范围**：YYYY/MM/DD - YYYY/MM/DD
**分析日期**：YYYY/MM/DD

## 一、数据总览
[关键指标仪表盘]

## 二、内容效果分析
[文章类型对比、TOP 文章、最差文章]

## 三、时间模式
[发布时间效果、最佳发布时段]

## 四、读者行为
[阅读来源、行为漏斗]

## 五、增长分析
[粉丝趋势、增长归因]

## 六、健康度诊断
[6 维评分]

## 七、策略建议
### 立即行动（本周）
1. [具体建议]

### 短期优化（本月）
1. [具体建议]

### 长期规划（本季度）
1. [具体建议]
```

---

## 可视化

当数据量足够时，使用 Python (matplotlib/seaborn) 生成图表：

- **折线图**：阅读量/粉丝趋势
- **柱状图**：文章类型对比、TOP 文章排名
- **热力图**：发布时间 vs 阅读表现
- **饼图**：阅读来源分布
- **散点图**：阅读量 vs 互动率（找异常值）

图表保存为 PNG 文件，可直接用于报告。

---

## 工作流程

```
1. 用户提供数据文件（CSV/Excel）
   → 使用 xlsx skill 或 pandas 读取

2. 数据清洗与预处理
   → 处理缺失值、统一日期格式、计算衍生指标

3. 运行分析模块（按用户需求选择）
   → 可全量分析或只分析特定模块

4. 生成可视化图表
   → 保存为 PNG 文件

5. 输出分析报告
   → 保存为 Markdown 文件

6. 给出可执行的策略建议
   → 结合 content-planner 调整后续选题
```

## 关键原则

- **数据说话**：所有结论必须有数据支撑，不凭感觉
- **对比思维**：单个数字没意义，要有环比/同比/行业均值对比
- **可执行性**：分析的最终目的是指导行动，每个发现都要有对应建议
- **不过度解读**：样本量太小时（如只有 5 篇文章），要明确说明置信度不高
- **隐私意识**：用户数据不外传，分析在本地完成
